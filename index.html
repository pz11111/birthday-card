<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Happy Birthday ğŸ‚</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<script src="https://unpkg.com/three@0.128.0/build/three.min.js"></script>
<script src="https://unpkg.com/three@0.128.0/examples/js/libs/fflate.min.js"></script>
<script src="https://unpkg.com/three@0.128.0/examples/js/loaders/FBXLoader.js"></script>



  <style>
  @font-face {
    font-family: "Mosseta-Regular";
    src: url("Mosseta-Regular.otf") format("opentype");
    font-weight: normal;
    font-style: normal;
  }

  @font-face {
    font-family: "Rosehot";
    src: url("Rosehot.ttf") format("truetype");
    font-weight: normal;
    font-style: normal;
  }

  @font-face {
    font-family: "Autumn Brush";
    src: url("Autumn Brush.otf") format("opentype");
    font-weight: normal;
    font-style: normal;
  }

  @font-face {
    font-family: "Crustaceans-SignatureDEMO-Regular";
    src: url("Crustaceans-SignatureDEMO-Regular.otf") format("opentype");
    font-weight: normal;
    font-style: normal;
  }

  @font-face {
    font-family: "Bizantheum";
    src: url("Bizantheum.otf") format("opentype");
    font-weight: normal;
    font-style: normal;
  }

  * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }

  body {
    scroll-behavior: smooth;
    min-height: 100vh;
    font-family: "Rosehot", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;
    display: flex;
    align-items: center;
    justify-content: center;
    background: radial-gradient(circle at top, #ffd6e8, #f2f4ff, #ffe8cc);
    color: #333;
    overflow-x: hidden;
    overflow-y: auto;
  }

  /* ===== OVERLAY + ENVELOPE BUTTON ===== */

  .overlay {
    position: fixed;
    inset: 0;
    background: radial-gradient(circle at top, #ff9eb5, #b49bff);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 1.8rem;
    z-index: 10;
    text-align: center;
    color: white;
    padding: 1.5rem;
    transition: opacity 0.8s ease, transform 0.8s ease, filter 0.8s ease;
  }

  .overlay-title {
    font-size: 2.1rem;
    letter-spacing: 0.08em;
    text-transform: uppercase;
  }

  .overlay-subtitle {
    font-size: 1rem;
    opacity: 0.92;
  }

  .overlay.fade-out {
    opacity: 0;
    transform: translateY(-18px);
    filter: blur(10px);
    pointer-events: none;
  }

  .envelope-wrapper {
    position: relative;
    width: 260px;
    height: 180px;
    cursor: pointer;
    perspective: 900px;
  }

  .envelope-back {
    position: absolute;
    inset: 18px;
    background: linear-gradient(145deg, #ffe6f0, #ffd0e1);
    border-radius: 18px;
    box-shadow: 0 18px 40px rgba(233, 89, 134, 0.6);
    border: 1px solid rgba(255, 170, 204, 0.9);
  }

  .envelope-paper {
    position: absolute;
    inset: 26px 26px 34px;
    background: #fff;
    border-radius: 12px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 0.35rem;
    transform: translateY(18px);
    transition: transform 0.6s cubic-bezier(0.22, 0.61, 0.36, 1);
    z-index: 2;
  }

  .envelope-paper p {
    font-size: 0.95rem;
    color: #555;
  }

  .envelope-paper p:first-child {
    font-weight: 600;
  }

  .envelope-flap {
    position: absolute;
    inset: 18px;
    background: linear-gradient(145deg, #ffb6cf, #ff9eb5);
    clip-path: polygon(0 0, 100% 0, 50% 70%);
    transform-origin: top;
    transform-style: preserve-3d;
    transition: transform 0.6s cubic-bezier(0.19, 1, 0.22, 1);
    z-index: 3;
    box-shadow: 0 14px 30px rgba(245, 130, 177, 0.5);
  }

  .envelope-seal {
    position: absolute;
    top: 52%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 34px;
    height: 34px;
    border-radius: 999px;
    background: radial-gradient(circle at 30% 20%, #ffe7f0, #ff7c9f);
    box-shadow: 0 0 10px rgba(255, 163, 195, 0.9);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.1rem;
    color: #fff;
  }

  .envelope-wrapper.open .envelope-flap {
    transform: rotateX(180deg);
  }

  .envelope-wrapper.open .envelope-paper {
    transform: translateY(-22px);
  }

  .overlay-hint {
    font-size: 0.9rem;
    opacity: 0.9;
  }

  /* ===== MAIN LAYOUT ===== */

  .container {
    position: relative;
    max-width: 960px;
    width: 100%;
    padding: 1.5rem;
    z-index: 1;
  }

  .hero {
    min-height: 0vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 1.4rem;
    opacity: 0;
    transform: translateY(24px);
    transition: opacity 0.8s ease, transform 0.8s ease;
  }

  .hero.show {
    opacity: 1;
    transform: translateY(0);
  }

  .hero-caption {
    font-size: 1rem;
    color: #b25b81;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    background: rgba(255, 181, 208, 0.2);
    padding: 0.35rem 0.9rem;
    border-radius: 999px;
    border: 1px solid rgba(255, 181, 208, 0.7);
    backdrop-filter: blur(8px);
  }

  .hero-row {
    display: flex;
    justify-content: center;
    width: 100%;
    max-width: 720px;
  }

  /* ===== 3D CAKE CONTAINER ===== */

  .cake-3d {
    position: relative;
    width: 340px;
    height: 340px;
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.7s ease, transform 0.7s ease;
  }

  .cake-3d.show {
    opacity: 1;
    transform: translateY(0);
  }

  /* ===== CARD (TEXT + PHOTO) ===== */

  .card {
    border-radius: 24px;
    background: rgba(255, 255, 255, 0.92);
    backdrop-filter: blur(16px);
    box-shadow: 0 18px 55px rgba(6, 6, 224, 0.22);
    padding: 1.2rem 1.4rem;
    margin-top: 1.4rem;
    opacity: 0;
    transform: translateY(24px);
    transition: opacity 0.8s ease 0.2s, transform 0.8s ease 0.2s;
  }

  .card.show {
    opacity: 1;
    transform: translateY(0);
  }

  @media (min-width: 720px) {
    .card {
      padding: 2rem;
      display: grid;
      grid-template-columns: minmax(0, 1.1fr) minmax(0, 0.9fr);
      gap: 1.8rem;
      align-items: center;
    }
  }

  .title {
    font-size: 2.2rem;
    line-height: 1.2;
    margin-bottom: 0.4rem;
    background-image: linear-gradient(120deg, #ff7eb3, #ffb347, #937bff);
    -webkit-background-clip: text;
    color: transparent;
  }

  .subtitle {
    font-size: 1.05rem;
    color: #666;
    margin-bottom: 1.1rem;
  }

  .tagline {
    display: inline-flex;
    align-items: center;
    gap: 0.35rem;
    font-size: 0.9rem;
    padding: 0.25rem 0.7rem;
    border-radius: 999px;
    background: rgba(255, 181, 208, 0.2);
    color: #c1557f;
    margin-bottom: 0.9rem;
  }

  .tagline-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: #ff7eb3;
    box-shadow: 0 0 0 6px rgba(255, 126, 179, 0.3);
  }

  .message {
    font-family: "Autumn Brush", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;
    text-align: start;
    text-shadow: #9fd5ff;
    font-size: 1.2rem;
    line-height: 1.5;
    color: #444;
    margin-top: 0.5rem;
    white-space: pre-line;
  }

  .sign {
    margin-top: 1.3rem;
    font-size: 0.9rem;
    color: #777;
    text-align: right;
  }

  .sign span {
    font-weight: 600;
    color: #c1557f;
  }
/* å¤–å±‚å®¹å™¨ï¼šå æ»¡è¿™ä¸€åˆ—ï¼Œä½†é‡Œé¢çš„ frame å±…ä¸­ */
.photo-wrapper {
  position: relative;
  width: 100%;
  max-width: 100%;
  margin: 1rem auto 0;

  display: flex;
  flex-direction: column;
  align-items: center;     /* ğŸ‘‰ è®©ç›¸æ¡†å’Œæ–‡å­—éƒ½å±…ä¸­ */
}

/* ç›¸æ¡†æœ¬ä½“ï¼šå®½åº¦è·Ÿç€åˆ—å˜ï¼Œé«˜åº¦æŒ‰æ¯”ä¾‹ç®—ï¼Œå¹¶é™åˆ¶æœ€å¤§å®½åº¦ï¼Œé˜²æ­¢å·¨å¤§æ— æ¯” */
.photo-slider {
  position: relative;
  width: 100%;
  max-width: 260px;        /* ğŸ‘‰ æœ€å¤§å°±è¿™ä¹ˆå®½ï¼Œç”µè„‘ä¸Šä¸ä¼šå†å˜å¾—å¾ˆå¤§ */

  aspect-ratio: 4 / 5;     /* ğŸ‘‰ ç«–ç‰ˆæ¯”ä¾‹ï¼Œè·Ÿå¸¸è§ç…§ç‰‡å·®ä¸å¤š */
  border-radius: 24px;
  overflow: hidden;
  box-shadow: 0 18px 45px rgba(252, 170, 170, 0.466);
  border: 6px solid #fff;
  background: #ffffff;   /* ä½ çš„åŸåº•è‰² */
}

/* âœ… ä¸å†å†™æ­»é«˜åº¦ï¼Œä¹Ÿä¸éœ€è¦åª’ä½“æŸ¥è¯¢é‚£ä¸ª height 320px äº† */
@media (min-width: 720px) {
  .photo-slider {
    /* ä¿ç•™ç©ºçš„å°±è¡Œï¼Œä¸è¦å†è®¾ height */
  }
}

/* å†…éƒ¨æ»‘åŠ¨åŒºåŸŸï¼šç»å¯¹é“ºæ»¡æ•´ä¸ª frameï¼Œæ²¡æœ‰ç©ºéš™ */
.photo-strip {
  align-self: center;
  align-items: center;
  align-content: center;
  position: absolute;
  inset: 0;                /* top/right/bottom/left å…¨ 0 */
  width: 100%;
  height: 100%;

  display: flex;
  overflow-x: auto;
  scroll-snap-type: x mandatory;
  scroll-behavior: smooth;
}

.photo-strip::-webkit-scrollbar {
  display: none;
}

/* æ¯å¼ å›¾ä¸€é¡µï¼Œå®½ = æ•´ä¸ª frame å®½ï¼Œé«˜ = frame é«˜ */
.photo-slide {
  flex: 0 0 100%;
  height: 100%;
  scroll-snap-align: center;
  display: flex;
}

/* å›¾ç‰‡å¡«æ»¡æ•´é¡µï¼Œè·Ÿç€ frame ä¸€èµ·ç¼©æ”¾ï¼Œæ²¡æœ‰é»‘è¾¹ */
.photo-img {
  width: 100%;
  height: 100%;
  object-fit: cover;       /* è¶…å‡ºéƒ¨åˆ†è£æ‰ï¼Œä¸å˜å½¢ */
  display: block;
  border-radius: 18px;     /* æ¯”ç›¸æ¡†å°ä¸€ç‚¹ï¼Œç•™ä¸€ç‚¹â€œå†…è¾¹è·â€æ„Ÿ */
}




  .typed-cursor {
    display: inline-block;
    width: 9px;
    margin-left: 3px;
    border-radius: 50px;
    background: #ff9eb5;
    animation: blink 0.85s step-start infinite;
  }

  @keyframes blink {
    50% {
      opacity: 0;
    }
  }

  .footer-note {
    margin-top: 0.9rem;
    font-size: 0.8rem;
    color: #aaa;
    text-align: center;
  }

  /* ===== BALLOONS (background) ===== */

  .balloon {
    position: fixed;
    width: 50px;
    height: 70px;
    border-radius: 50px 50px 45px 45px;
    background: #ff9eb5;
    opacity: 0.75;
    animation: float 16s linear infinite;
    transform: translateY(100vh);
    z-index: 0;
  }

  .balloon::after {
    content: "";
    position: absolute;
    bottom: -25px;
    left: 50%;
    width: 2px;
    height: 30px;
    background: rgba(0, 0, 0, 0.15);
    transform: translateX(-50%);
  }

  .balloon.b2 {
    background: #ffce73;
    animation-duration: 19s;
    animation-delay: 2s;
    left: 10%;
  }

  .balloon.b3 {
    background: #9fd5ff;
    animation-duration: 21s;
    animation-delay: 4s;
    left: 80%;
  }

  .balloon.b1 {
    left: 20%;
  }

  .balloon.b4 {
    background: #c9a4ff;
    animation-duration: 23s;
    animation-delay: 6s;
    left: 60%;
  }

  @keyframes float {
    0% {
      transform: translateY(100vh);
    }
    100% {
      transform: translateY(-120vh);
    }
  }

  /* ğŸŒ¸ FLOWER SPRAY (ephemeral) */

  .flower-spray {
    position: fixed;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background-image: url("petals.png");
    background-position: center;
    background-repeat: no-repeat;
    background-size: contain;
    background-color: #dfc4ce;
    box-shadow: 0 0 10px rgba(255, 143, 184, 0.8);
    pointer-events: none;
    z-index: 5;
    opacity: 0.5;
    transform: translate(0, 0) scale(0.8);
    animation: flowerSpray 1.8s ease-out forwards;
  }

  .flower-spray::before,
  .flower-spray::after {
    content: "";
    position: absolute;
    inset: -6px;
    border-radius: 50%;
    border: 2px solid rgba(214, 172, 172, 0.712);
    opacity: 0.6;
  }

  .flower-spray::after {
    inset: -11px;
    opacity: 0.35;
  }

  @keyframes flowerSpray {
    0% {
      opacity: 0;
      transform: translate(0, 0) scale(0.2);
    }
    15% {
      opacity: 1;
    }
    70% {
      opacity: 1;
    }
    100% {
      opacity: 0;
      transform: translate(var(--tx), var(--ty)) scale(1);
    }
  }

  /* ===== MOBILE TWEAKS FOR IPHONE 13 (390px wide) ===== */

  @media (max-width: 480px) {
    body {
      align-items: flex-start;
    }

    .overlay {
      padding: 1.2rem;
    }

    .overlay-title {
      font-size: 1.4rem;
    }

    .overlay-subtitle,
    .overlay-hint {
      font-size: 0.85rem;
      max-width: 280px;
      margin: 0 auto;
    }

    .envelope-wrapper {
      width: 220px;
      height: 150px;
    }

    .envelope-paper p {
      font-size: 0.88rem;
    }

    .container {
      padding: 1rem 0.9rem 1.2rem;
    }

    .hero {
      min-height: 48vh;
      gap: 1rem;
    }

    .hero-caption {
      font-size: 0.8rem;
      padding: 0.3rem 0.7rem;
    }

    .card {
      margin-top: 1rem;
      padding: 1.1rem 1rem;
    }

    .title {
      font-size: 1.8rem;
    }

    .subtitle {
      font-size: 0.95rem;
    }

    .tagline {
      font-size: 0.82rem;
    }

    .message {
      font-size: 0.92rem;
    }

    .sign {
      font-size: 0.85rem;
    }

    .photo-wrapper {
      max-width: 260px;
      margin-top: 1.1rem;
    }

    .footer-note {
      font-size: 0.75rem;
      padding: 0 1rem;
    }
  }
  </style>
</head>
<body>

  <!-- Background musicï¼ˆæŒ‰ä½ è‡ªå·±çš„æ–‡ä»¶åæ”¹ï¼‰ -->
  <audio id="bgm" src="b1.m4a" preload="auto" loop></audio>
  <audio id="bgmCake" src="b2.m4a" preload="auto"></audio>

  <!-- OPENING OVERLAY WITH ENVELOPE -->
  <div class="overlay" id="overlay">
    <div>
      <div class="overlay-title">BIRTHDAY SECRET</div>
    </div>

    <div class="envelope-wrapper" id="envelope">
      <div class="envelope-back"></div>
      <div class="envelope-paper">
        <p>To: SAM</p>
        <p>Open Here</p>
      </div>
      <div class="envelope-flap">
        <div class="envelope-seal">â™¡</div>
      </div>
    </div>

    <div class="overlay-hint">Click the letter âœ‰ï¸</div>
  </div>

  <!-- BACKGROUND BALLOONS -->
  <div class="balloon b1"></div>
  <div class="balloon b2"></div>
  <div class="balloon b3"></div>
  <div class="balloon b4"></div>

  <!-- MAIN CONTENT -->
  <div class="container">
    <!-- HERO: 3D CAKE -->
    <div class="hero" id="hero">
      <div class="hero-caption">For my favourite person in the world</div>

      <div class="hero-row">
        <div class="cake-3d" id="cake3d-container"></div>
      </div>
    </div>

    <!-- CARD WITH MESSAGE + PHOTO -->
    <div class="card" id="card">
      <div>
        <h2 class="title">Happy Birthday â™¡</h2>
        <div class="subtitle">
          Another year older, another year wiser.
        </div>

        <div class="message">
          <span id="typed"></span><span class="typed-cursor" id="cursor"></span>
        </div>
      </div>
      <div class="photo-wrapper">
        <div class="photo-slider">
          <div class="photo-strip">
            <!-- Each slide = 1 full-frame photo -->
            <div class="photo-slide">
              <img src="Image (3).jpg" alt="Memory 1" class="photo photo-small" />
            </div>
            <div class="photo-slide">
              <img src="Image (4).jpg" alt="Memory 2" class="photo photo-small" />
            </div>
            <div class="photo-slide">
              <img src="Image (5).jpg" alt="Memory 3" class="photo photo-small" />
            </div>
            <div class="photo-slide">
              <img src="Image (6).jpg" alt="Memory 4" class="photo photo-small" />
            </div>
            <div class="photo-slide">
              <img src="Image (7).jpg" alt="Memory 4" class="photo photo-small" />
            </div>
            <div class="photo-slide">
              <img src="Image (8).jpg" alt="Memory 4" class="photo photo-small" />
            </div>
            <div class="photo-slide">
              <img src="Image (9).jpg" alt="Memory 4" class="photo photo-small" />
            </div>
            <div class="photo-slide">
              <img src="Image (10).jpg" alt="Memory 4" class="photo photo-small" />
            </div>
            <div class="photo-slide">
              <img src="Image (11).jpg" alt="Memory 4" class="photo photo-small" />
            </div>
            <div class="photo-slide">
              <img src="Image (12).jpg" alt="Memory 4" class="photo photo-small" />
            </div>
            <div class="photo-slide">
              <img src="Image (13).jpg" alt="Memory 4" class="photo photo-small" />
            </div>
            <div class="photo-slide">
              <img src="Image (14).jpg" alt="Memory 4" class="photo photo-small" />
            </div>
            <div class="photo-slide">
              <img src="Image (15).jpg" alt="Memory 4" class="photo photo-small" />
            </div>
            <div class="photo-slide">
              <img src="Image (16).jpg" alt="Memory 4" class="photo photo-small" />
            </div>
            <div class="photo-slide">
              <img src="Image (17).jpg" alt="Memory 4" class="photo photo-small" />
            </div>
            <div class="photo-slide">
              <img src="Image (18).jpg" alt="Memory 4" class="photo photo-small" />
            </div>
            <!-- add more if you like -->
            <!-- <div class="photo-slide"><img src="photo4.jpg" alt="Memory 4" class="photo-img" /></div> -->
          </div>
        </div>
      </div>


    <div class="footer-note">
      This little page lights up only for sam today. âœ¨
    </div>
  </div>

  <!-- å…¨éƒ¨é€»è¾‘è„šæœ¬ï¼ˆé moduleï¼‰ -->
  <script>
    // ========== Typewriter message ==========
    const fullMessage = `

    Dear Sam ğŸº

    Itâ€™s your special day again, and I just want to say:
    Thank you for being you and light up my life like a sunshine come through the clouds.
    Thank you for letting me to participate in your life.

    After we met, I learned so much from you, about kindness, and what is love. 
    I always felt love is more about money, gifts, surprises... but you taught me love is actually about being patient, being present, and being real.
    Thank you for being my teacher in love. And thanks for loving me back.

    I'm sorry for the times I made you feel sad or hurt.
    I never meant to, and I will keep trying to be better for you.
    Sometimes I may just don't know how to show my feeling in the right way for you, you taught me to be more open and honest, and I am learning.
    Just bit of slow lol.

    Look back at all the things we have done this year, we are so lucky to have each other and both survived in a miracle way.
    We were in student center, science library, gardern hall, camden market, winter wonderland, wihtechaple, clapham north, kew garden, brunswick square, ucl gym, and so many more places together.
    We cooked together, we laughed together, we cried together.
    
    We supported each other, we grew together.
    Although sometimes I'm a bit immature and childish, you always patiently hold my hand and walk with me through all the ups and downs.
    You are my hero, my rock, my sunshine.
    I hope I can be yours too.

    In this new year of your life, I wish you:
    Keep healthy and happy,
    be brave to chase your dreams,
    have faith in yourself,
    and never forget to love yourself as much as I love you.

    Happy birthday my dearest Sam.
    With all my love,
    PeipeiğŸ‡
    `.trim();

    const typedSpan = document.getElementById("typed");
    const cursorSpan = document.getElementById("cursor");
    const hero = document.getElementById("hero");
    const card = document.getElementById("card");
    const cakeContainer = document.getElementById("cake3d-container");
    const overlay = document.getElementById("overlay");
    const envelope = document.getElementById("envelope");
    const bgm = document.getElementById("bgm");
    const bgmCake = document.getElementById("bgmCake");
    const titleEl = document.querySelector(".title");

    // ç‚¹å‡»æ ‡é¢˜ï¼Œæ’­æ”¾/æš‚åœç¬¬äºŒé¦–æ­Œ
    if (cakeContainer && bgmCake) {
      cakeContainer.style.cursor = "pointer";
      cakeContainer.addEventListener("click", () => {
        bgmCake.volume = 0.8;
        if (bgmCake.paused) {
          bgmCake.play().catch(() => {});
        } else {
          bgmCake.pause();
        }
      });
    }

    let index = 0;

    function typeNextChar() {
      if (index < fullMessage.length) {
        const char = fullMessage[index];
        typedSpan.textContent += char;
        index++;

        let delay = 38;
        if (char === "." || char === "!" || char === "?" || char === "\n") {
          delay = 250;
        }
        setTimeout(typeNextChar, delay);
      } else {
        cursorSpan.style.display = "none";
      }
    }

    // ğŸŒ¸ One-time flower spray
    function launchFlowerSpray() {
      const centerX = window.innerWidth / 2;
      const centerY = window.innerHeight / 2;

      const count = 22;
      for (let i = 0; i < count; i++) {
        const flower = document.createElement("div");
        flower.className = "flower-spray";

        const angle = Math.random() * Math.PI * 2;
        const distance = 80 + Math.random() * 160;
        const tx = Math.cos(angle) * distance;
        const ty = Math.sin(angle) * distance - 40;

        flower.style.left = centerX + "px";
        flower.style.top = centerY + "px";
        flower.style.setProperty("--tx", tx + "px");
        flower.style.setProperty("--ty", ty + "px");
        flower.style.animationDelay = (Math.random() * 0.25) + "s";

        document.body.appendChild(flower);

        setTimeout(() => {
          flower.remove();
        }, 2000);
      }
    }



    // ğŸ‚ åˆå§‹åŒ– 3D è›‹ç³•ï¼ˆå…¨å±€ THREE + THREE.FBXLoaderï¼‰
    function init3DCake() {
      if (!cakeContainer) {
        console.warn("no cake3d-container element");
        return;
      }
      if (typeof THREE === "undefined") {
        console.warn("THREE not found");
        return;
      }
      if (!THREE.FBXLoader) {
        console.warn("THREE.FBXLoader not found");
        return;
      }

      const width = cakeContainer.clientWidth || 140;
      const height = cakeContainer.clientHeight || 140;

      const scene = new THREE.Scene();
      scene.background = null;

      const camera = new THREE.PerspectiveCamera(60, width / height, 0.1, 100);
      camera.position.set(0, 1.5, 5);
      camera.lookAt(0, 0, 0);

      const renderer = new THREE.WebGLRenderer({
        alpha: true,
        antialias: true,
      });
      renderer.setSize(width, height);
      renderer.setPixelRatio(window.devicePixelRatio || 1);
      cakeContainer.innerHTML = "";
      cakeContainer.appendChild(renderer.domElement);

      const dirLight = new THREE.DirectionalLight(0xffffff, 1.2);
      dirLight.position.set(3, 5, 4);
      scene.add(dirLight);

      const ambient = new THREE.AmbientLight(0xffe0f0, 0.7);
      scene.add(ambient);

      const loader = new THREE.FBXLoader();
      let cakeModel = null;

      loader.load(
        "cake1.fbx", // ç¡®ä¿ cake.fbx å’Œ index.html åœ¨åŒä¸€å±‚ç›®å½•
        function (object) {
          console.log("FBX loaded");
          cakeModel = object;

          object.traverse(function (child) {
            if (child.isMesh) {
              child.castShadow = false;
              child.receiveShadow = false;
            }
          });

          object.scale.set(0.0026, 0.0026, 0.0026);
          object.position.set(0, -3, 0);
          scene.add(object);
        },
        undefined,
        function (error) {
          console.error("Error loading FBX cake:", error);
        }
      );

      function animate() {
        requestAnimationFrame(animate);
        if (cakeModel) {
          cakeModel.rotation.y += 0.01;
        }
        renderer.render(scene, camera);
      }
      animate();

      window.addEventListener("resize", function () {
        const newWidth = cakeContainer.clientWidth || 140;
        const newHeight = cakeContainer.clientHeight || 140;
        renderer.setSize(newWidth, newHeight);
        camera.aspect = newWidth / newHeight;
        camera.updateProjectionMatrix();
      });
    }

    // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ– 3D è›‹ç³•
    window.addEventListener("load", init3DCake);

    // ä¿¡å°ç‚¹å‡»é€»è¾‘
    envelope.addEventListener("click", function () {
      if (envelope.classList.contains("open")) return;

      envelope.classList.add("open");

      // èƒŒæ™¯éŸ³ä¹ 1
      if (bgm) {
        bgm.volume = 0.8;
        bgm.play().catch(function () {});
      }

      // èŠ±ç“£
      setTimeout(function () {
        launchFlowerSpray();
      }, 280);

      // æ˜¾ç¤º hero + è›‹ç³•å®¹å™¨
      setTimeout(function () {
        hero.classList.add("show");
        if (cakeContainer) {
          cakeContainer.classList.add("show");
        }
      }, 250);

      // éšè—é®ç½©
      setTimeout(function () {
        overlay.classList.add("fade-out");
      }, 600);

      // æ˜¾ç¤º card + æ‰“å­—æœº
      setTimeout(function () {
        card.classList.add("show");
        typeNextChar();
      }, 1100);
    });


    // Make photo slider usable with mouse wheel on desktop
const photoStrip = document.querySelector(".photo-strip");
if (photoStrip) {
  photoStrip.addEventListener(
    "wheel",
    (e) => {
      // å¦‚æœæ˜¯å‚ç›´æ»šåŠ¨ï¼Œå°±è½¬æˆæ¨ªå‘æ»šåŠ¨
      if (Math.abs(e.deltaY) > Math.abs(e.deltaX)) {
        e.preventDefault(); // ç¦æ­¢é»˜è®¤çš„æ•´é¡µä¸Šä¸‹æ»šåŠ¨
        photoStrip.scrollLeft += e.deltaY; // ç”¨æ»šè½®å‚ç›´é‡æ¥æ§åˆ¶æ¨ªå‘æ»šåŠ¨
      }
    },
    { passive: false }
  );
}

  </script>
</body>
</html>
